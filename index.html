<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบทดสอบออนไลน์ - Fixed Version</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Prompt', sans-serif; background-color: #f0f2f5; }
        .option-label {
            display: block; padding: 14px 18px; margin-bottom: 10px;
            background-color: white; border: 2px solid #e2e8f0;
            border-radius: 12px; cursor: pointer; transition: all 0.2s;
        }
        .option-label:hover { border-color: #cbd5e1; background-color: #f8fafc; }
        input[type="radio"]:checked + .option-label {
            border-color: #3b82f6; background-color: #eff6ff;
            font-weight: 600; color: #1d4ed8;
        }
        input[type="radio"] { display: none; }
        .sticky-header { position: sticky; top: 0; z-index: 50; background: rgba(255,255,255,0.9); backdrop-filter: blur(8px); }
    </style>
</head>
<body>

    <div id="menu-screen" class="min-h-screen flex items-center justify-center p-6">
        <div class="bg-white p-10 rounded-3xl shadow-xl max-w-2xl w-full text-center border border-gray-100">
            <h1 class="text-4xl font-black text-slate-800 mb-4">Quiz Center</h1>
            <p class="text-gray-500 mb-10">กรุณาเลือกวิชาที่ต้องการทดสอบ ระบบจะจับเวลา 60 นาที</p>
            <div class="grid grid-cols-1 gap-4">
                <button onclick="startQuiz('hp22102')" class="flex items-center justify-between p-6 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl transition-all shadow-lg shadow-blue-200">
                    <span class="text-xl font-bold">HP 22102: Review</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                </button>
                <button onclick="startQuiz('arjey1')" class="flex items-center justify-between p-6 bg-emerald-600 hover:bg-emerald-700 text-white rounded-2xl transition-all shadow-lg shadow-emerald-200">
                    <span class="text-xl font-bold">Arjey 1: Environment & Rocks</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                </button>
                <button onclick="startQuiz('arjey2')" class="flex items-center justify-between p-6 bg-purple-600 hover:bg-purple-700 text-white rounded-2xl transition-all shadow-lg shadow-purple-200">
                    <span class="text-xl font-bold">Arjey 2: Earth's Layers</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                </button>
            </div>
        </div>
    </div>

    <div id="quiz-screen" class="hidden min-h-screen pb-20">
        <div class="sticky-header border-b border-gray-200 px-4 py-4 shadow-sm">
            <div class="max-w-4xl mx-auto flex justify-between items-center">
                <div>
                    <h1 id="quiz-title" class="text-xl font-bold text-gray-800">Title</h1>
                    <div id="timer" class="text-red-500 font-mono font-bold text-lg leading-none">60:00</div>
                </div>
                <button onclick="exitQuiz()" class="bg-gray-100 hover:bg-red-50 hover:text-red-600 text-gray-600 px-4 py-2 rounded-xl font-bold transition-colors border border-gray-200">
                    ออกจากห้องสอบ
                </button>
            </div>
        </div>

        <div class="max-w-4xl mx-auto px-4 py-8">
            <div id="discussion-box" class="hidden mb-10 bg-white border-l-8 border-blue-500 p-8 rounded-2xl shadow-sm">
                <h3 class="text-xl font-black text-blue-600 mb-4 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
                    Short Discussion (อ่านก่อนทำ)
                </h3>
                <div id="discussion-text" class="text-gray-700 leading-relaxed whitespace-pre-line text-lg"></div>
            </div>

            <div id="questions-container" class="space-y-8"></div>

            <button onclick="confirmSubmit()" class="mt-12 w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-5 rounded-2xl shadow-xl text-xl transition-transform active:scale-95">
                ส่งคำตอบทั้งหมด
            </button>
        </div>
    </div>

    <div id="result-screen" class="hidden min-h-screen py-10 px-4 bg-slate-50">
        <div class="max-w-3xl mx-auto">
            <div class="bg-white p-10 rounded-3xl shadow-xl text-center mb-10 border border-gray-100">
                <h2 class="text-2xl font-bold text-gray-500">คะแนนที่คุณได้</h2>
                <div class="text-7xl font-black text-blue-600 my-6"><span id="score-display">0</span> / <span id="total-display">0</span></div>
                <button onclick="location.reload()" class="bg-blue-600 text-white px-8 py-3 rounded-full font-bold hover:bg-blue-700 transition-all shadow-lg shadow-blue-100">กลับหน้าหลัก</button>
            </div>
            <div id="review-container" class="space-y-6"></div>
        </div>
    </div>

    <script>
        const quizData = {
            "hp22102": {
                title: "HP 22102: Health & PE Review",
                discussion: "Topics: Drug Rehabilitation, Risky Behaviors, and Emergency Situations.\nPlease read each question carefully. Most questions focus on self-protection and correct medical procedures.",
                questions: [
                    { q: "1. Which of the following is not the rehabilitation of drug addicts?", options: ["A. Take care those who have stopped using drugs.", "B. Invite friends who also use drugs before to exercise regularly.", "C. Hang out with drug addicts.", "D. Arrange dancing competition for friends who have stopped using drugs."], ans: 2 },
                    { q: "2. Which factor helps the drug addict stop using drugs permanently?", options: ["A. Doctors and nurses", "B. Drug cartels", "C. Family and oneself", "D. Drug pushers"], ans: 2 },
                    { q: "3. Which of the following is a mental way of drug addicts’ rehabilitation?", options: ["A. Using electric wave", "B. Using methadone", "C. Religious treatment", "D. Using herbs"], ans: 2 },
                    { q: "4. Which one is correct regarding sources of assistance and rehabilitation of drug addicts?", options: ["A. It is the organization that treats many drug addicts.", "B. It is a governmental organization that deals with drug addicts.", "C. It is the organization that provides medical treatment to people.", "D. It is a specific organization for mental treatment."], ans: 1 },
                    { q: "5. Which of the following rehabilitation accepts patients to be treated in the hospital?", options: ["A. In-patient rehabilitation", "B. Out-patient rehabilitation", "C. Taking action and following up the result", "D. Analyzing the cause of addiction."], ans: 0 },
                    { q: "6. Which of the following is not a physical rehabilitation of drug addicts?", options: ["A. Religious Treatment", "B. Using anti-drugs", "C. Using herbs as a medicine", "D. Using electric wave"], ans: 0 },
                    { q: "7. If a drug addict captures you as a hostage, what should you do?", options: ["A. Blame the drug addict with cruel words", "B. Persuade the drug addict", "C. Fight as much as possible", "D. Shout for help from those around the area"], ans: 1 },
                    { q: "8. Which is not a stage of the treatment of drug addicts as an out-patient of the Ministry of Public Health?", options: ["A. Preparing stage", "B. Drug-activating stage", "C. Rehabilitation Stage", "D. Following-up stage"], ans: 1 },
                    { q: "9. Which one is the mental treatment for drug addicts?", options: ["A. Consulting with psychiatrist.", "B. Using medicine to stimulate nervous system.", "C. Maintaining drugs.", "D. Using anti-drugs medicine"], ans: 0 },
                    { q: "10. Which of the following is the right way to treat drug addicts?", options: ["A. Seeing the doctor regularly.", "B. Reducing the number of drugs but still using drugs every day.", "C. Stop seeing the doctor after using drugs in the beginning stage.", "D. Trying to stop using drugs by taking medicine."], ans: 0 },
                    { q: "11. Who creates the value of oneself after the treatment regarding drug addiction?", options: ["A. Areeya stays at home because she feels embarrassed", "B. Krittika applies for a job as a waitress in the restaurant", "C. Sirima blames herself for using drugs", "D. Nut hangs out with drug addicts"], ans: 1 },
                    { q: "12. What is the old way of treating drug addicts?", options: ["A. Psychiatrist", "B. Herb", "C. Electric wave", "D. Group Activity"], ans: 1 },
                    { q: "13. Which of the following has a relationship with the treatment of out-patients at the Ministry of Public Health?", options: ["A. Treating at the institution and staying there.", "B. Appointing patients to receive medicine.", "C. Being a regular patient in the hospital.", "D. Joining the activities of the institution all the time."], ans: 1 },
                    { q: "14. What should you do to avoid vices?", options: ["A. Racing with friends", "B. Hanging out with gamblers", "C. Watching friends gambling", "D. Refusing/stop hanging out with gamblers"], ans: 3 },
                    { q: "15. Which one is the use of life skills in daily life?", options: ["A. Acting according to your own satisfaction", "B. Being pessimistic", "C. Hanging out with those who have high education", "D. Knowing what you are doing"], ans: 3 },
                    { q: "16. Which one is not a risk situation?", options: ["A. Racing motorcycle on the road at night", "B. Travelling alone at night", "C. Hanging out with seniors and bad people", "D. Applying for football competition at school"], ans: 3 },
                    { q: "17. When being forced or raped by somebody, what is the right thing to do?", options: ["A. Stay away", "B. Try to postpone the time by talking nicely and gently.", "C. Shout very loud", "D. Run as fast as you can"], ans: 1 },
                    { q: "18. How to avoid being robbed?", options: ["A. Immediately call a friend.", "B. Do not walk alone in dangerous places.", "C. Wear expensive jewelries.", "D. Show your money to everyone"], ans: 1 },
                    { q: "19. What is the first step of the thinking process in living life?", options: ["A. Analyzing the cause of the problem", "B. Collecting data for making a decision", "C. Taking action and following-up the result", "D. Conclusion and evaluation"], ans: 1 },
                    { q: "20. Which behavior might lead to sexual intercourse the most?", options: ["A. Being alone with the opposite sex", "B. Having the opposite sex as a friend", "C. Sexy dressing", "D. Allowing the opposite sex to touch the body"], ans: 0 },
                    { q: "21. What is the condition or situation that one is facing at a certain moment?", options: ["A. Emergency Situation", "B. Good Health", "C. Holidays", "D. Stressful"], ans: 0 },
                    { q: "22. Which of the following is the effect of fighting?", options: ["A. Warm family", "B. Unity", "C. Hurting", "D. Educational institution loses reputation"], ans: 2 },
                    { q: "23. Which behavior might lead to having an accident the most?", options: ["A. Wearing a helmet while riding a motorcycle", "B. Limiting speed while driving", "C. Driving even when drunk", "D. Stopping the car when seeing a red-light"], ans: 2 },
                    { q: "24. Improving personality that causes confidence can be done by _____________.", options: ["A. Carrying a lot of money", "B. No exercise", "C. Assessing of feelings", "D. Dressing appropriately"], ans: 3 },
                    { q: "25. Which of the following is not a cause of fighting?", options: ["A. Wanting to win", "B. Jealousy and vengeance", "C. Conflict of interests", "D. Humility and forgiveness"], ans: 3 },
                    { q: "26. It means knowing the event that will happen in the future.", options: ["A. Prediction", "B. Life skills", "C. Negotiation", "D. Thinking Process"], ans: 0 },
                    { q: "27. It means talking in order to improve the situation or to avoid the risk situation.", options: ["A. Negotiation", "B. Thinking Process", "C. Prediction", "D. Life Skills"], ans: 0 },
                    { q: "28. Which emergency situation causes the loss of life and property?", options: ["A. Robbery", "B. Falling off a motorcycle", "C. Fire burning", "D. Exhausted after exercising"], ans: 2 },
                    { q: "29. Which one is the right thing to do during emergency situation?", options: ["A. Frightening and shouting", "B. Keeping valuable stuff as much as possible", "C. Concentrating and finding the ways to solve problem", "D. Fighting with the criminal"], ans: 2 },
                    { q: "30. The skill that helps in protecting oneself from danger in order to stop the criminal.", options: ["A. Negotiation", "B. Natural Disaster", "C. Refusing", "D. Self-protection"], ans: 3 },
                    { q: "31. A skill that can be used in daily life situation to avoid use of drugs, gambling and having sexual intercourse.", options: ["A. Forecasting", "B. Happenings", "C. Warning sign", "D. Refusing"], ans: 3 },
                    { q: "32. What should you do during earthquake?", options: ["A. Watch television", "B. Drive a car", "C. Use the elevator", "D. Stay away from a building"], ans: 3 },
                    { q: "33. Which is the most convenient and easiest way in order to ask for help during an emergency situation?", options: ["A. Send a text message through a mobile phone", "B. By shouting", "C. Run", "D. Write a message"], ans: 1 },
                    { q: "34. If you are in the storm, what should you do?", options: ["A. Run as fast as you can", "B. Hide in a strong and secure place.", "C. Hide under a big tree", "D. Stay outdoors"], ans: 1 },
                    { q: "35. If you need to fight with a criminal, what part of his body will you attack?", options: ["A. Knee", "B. Occipital bone", "C. Brachium", "D. Food"], ans: 0 },
                    { q: "36. What is the right thing to do when going to the waterfall?", options: ["A. Being in the deep water", "B. Being in the water area that other people do not go", "C. Getting out of the water when the water changes color", "D. Being in the water while raining"], ans: 2 },
                    { q: "37. If you are captured as a hostage, what should you do first?", options: ["A. Fight back with the criminal", "B. Wait for the police help", "C. Negotiation with nice and gentle words", "D. Resist"], ans: 2 },
                    { q: "38. Which place is at risk for being robbed?", options: ["A. The fresh market", "B. The park", "C. The department store", "D. An isolated place"], ans: 3 },
                    { q: "39. If you cannot solve an emergency situation, what will you do?", options: ["A. Call your parents", "B. Call your friends", "C. Call the school", "D. Call 191"], ans: 3 },
                    { q: "40. Which one is not a life skill for preventing and avoiding an emergency situation?", options: ["A. Refusing", "B. Negotiation", "C. Exercising", "D. Self-protection"], ans: 2 }
                ]
            },
            "arjey1": {
                title: "Arjey 1: Environment & Minerals",
                discussion: "• The air around Earth: Atmosphere\n• All water: Hydrosphere\n• Living things: Biosphere\n• Study of Env: Environmental Science\n• Minerals: Natural Solid materials\n• Rocks from cooled magma: Igneous\n• Small pieces: Sedimentary\n• Heat and Pressure: Metamorphic\n• Scale of hardness: Mohs scale",
                questions: [
                    { q: "1. The air around Earth is called the", options: ["A. Atmosphere", "B. Core", "C. Mantle", "D. Plate"], ans: 0 },
                    { q: "2. All water on Earth is called the", options: ["A. Atmosphere", "B. Hydrosphere", "C. Lithosphere", "D. Core"], ans: 1 },
                    { q: "3. Living things are part of the", options: ["A. Biosphere", "B. Core", "C. Mantle", "D. Plate"], ans: 0 },
                    { q: "4. Plants grow in", options: ["A. Soil", "B. Fire", "C. Metal", "D. Air"], ans: 0 },
                    { q: "5. Dirty air and water are examples of", options: ["A. Energy", "B. Pollution", "C. Weather", "D. Gas"], ans: 1 },
                    { q: "6. The study of the environment is called", options: ["A. Geology", "B. Environmental Science", "C. Astronomy", "D. Physics"], ans: 1 },
                    { q: "7. A person who studies the environment is called an", options: ["A. Environmental scientist", "B. Pilot", "C. Mechanic", "D. Chef"], ans: 0 },
                    { q: "8. Recycling helps reduce", options: ["A. Waste", "B. Oxygen", "C. Rain", "D. Rocks"], ans: 0 },
                    { q: "9. Too much greenhouse gas can cause", options: ["A. Global warming", "B. Snow", "C. Wind", "D. Earthquakes"], ans: 0 },
                    { q: "10. The ozone layer protects us from strong", options: ["A. UV rays", "B. Rain", "C. Snow", "D. Sand"], ans: 0 },
                    { q: "11. Rivers and lakes contain _______ water.", options: ["A. Salt", "B. Fresh", "C. Dirty", "D. Hot"], ans: 1 },
                    { q: "12. Cutting many trees is called", options: ["A. Planting", "B. Recycling", "C. Deforestation", "D. Cleaning"], ans: 2 },
                    { q: "13. Clean water is important for", options: ["A. Drinking", "B. Burning", "C. Melting", "D. Breaking"], ans: 0 },
                    { q: "14. Taking care of the environment is the job of", options: ["A. Scientists only", "B. Everyone", "C. Teachers only", "D. No one"], ans: 1 },
                    { q: "15. The water cycle includes rain and", options: ["A. Condensation", "B. Burning", "C. Freezing", "D. Cutting"], ans: 0 },
                    { q: "16. A mineral is a natural", options: ["A. Solid", "B. Liquid", "C. Gas", "D. Animal"], ans: 0 },
                    { q: "17. Rocks are made of", options: ["A. Minerals", "B. Water", "C. Air", "D. Clouds"], ans: 0 },
                    { q: "18. The study of minerals is called", options: ["A. Mineralogy", "B. Biology", "C. Ecology", "D. Astronomy"], ans: 0 },
                    { q: "19. The study of rocks is called", options: ["A. Petrology", "B. Zoology", "C. Botany", "D. Meteorology"], ans: 0 },
                    { q: "20. Igneous rocks form from cooled", options: ["A. Magma", "B. Water", "C. Soil", "D. Ice"], ans: 0 },
                    { q: "21. Sedimentary rocks are made from small pieces called", options: ["A. Sediments", "B. Waves", "C. Clouds", "D. Crystals"], ans: 0 },
                    { q: "22. Metamorphic rocks change because of heat and", options: ["A. Rain", "B. Pressure", "C. Wind", "D. Ice"], ans: 1 },
                    { q: "23. Granite is an example of an", options: ["A. Igneous", "B. Sedimentary", "C. Liquid", "D. Soft"], ans: 0 },
                    { q: "24. Marble is a rock", options: ["A. Igneous", "B. Sedimentary", "C. Metamorphic", "D. Gas"], ans: 2 },
                    { q: "25. The Mohs scale measures mineral", options: ["A. Color", "B. Hardness", "C. Size", "D. Shape"], ans: 1 },
                    { q: "26. Breaking rocks into small pieces is called", options: ["A. Weathering", "B. Melting", "C. Burning", "D. Cooling"], ans: 0 },
                    { q: "27. Moving rocks by wind or water is called", options: ["A. Erosion", "B. Freezing", "C. Heating", "D. Pressing"], ans: 0 },
                    { q: "28. The rock cycle shows how rocks", options: ["A. Change", "B. Sleep", "C. Shine", "D. Float"], ans: 0 },
                    { q: "29. Fossils are usually found in rocks", options: ["A. Sedimentary", "B. Igneous", "C. Melted", "D. Liquid"], ans: 0 },
                    { q: "30. Both mineralogy and petrology are part of", options: ["A. Biology", "B. Geology", "C. Astronomy", "D. Physics"], ans: 1 }
                ]
            },
            "arjey2": {
                title: "Arjey 2: Earth's Layers & Tectonics",
                discussion: "• 4 Layers: Crust, Mantle, Outer Core (Liquid), Inner Core (Solid).\n• We live on the: Crust.\n• Center of Earth: Core.\n• Thickest layer: Mantle.\n• Study of Earth: Geology.\n• Shaking ground: Earthquake.\n• Pacific Ring of Fire: Many Earthquakes and Volcanoes.\n• One plate under another: Subduction.",
                questions: [
                    { q: "1. Which layer do we live on?", options: ["A. Crust", "B. Mantle", "C. Core", "D. Inner core"], ans: 0 },
                    { q: "2. Which is the thickest layer of the Earth?", options: ["A. Crust", "B. Mantle", "C. Ocean", "D. Sky"], ans: 1 },
                    { q: "3. What is the center of the Earth called?", options: ["A. Crust", "B. Mantle", "C. Core", "D. Soil"], ans: 2 },
                    { q: "4. The outer core is", options: ["A. Solid", "B. Liquid", "C. Cold", "D. Air"], ans: 1 },
                    { q: "5. The inner core is very", options: ["A. Cold", "B. Hot", "C. Soft", "D. Wet"], ans: 1 },
                    { q: "6. The crust is broken into big pieces called", options: ["A. Plates", "B. Clouds", "C. Trees", "D. Waves"], ans: 0 },
                    { q: "7. Mountains are found on the Earth's", options: ["A. Core", "B. Surface", "C. Mantle", "D. Center"], ans: 1 },
                    { q: "8. As we go deeper inside the Earth, it gets", options: ["A. Colder", "B. Hotter", "C. Lighter", "D. Smaller"], ans: 1 },
                    { q: "9. The study of the Earth and its layers is called", options: ["A. Biology", "B. Geology", "C. Astronomy", "D. Chemistry"], ans: 1 },
                    { q: "10. A scientist who studies the Earth is called a", options: ["A. Biologist", "B. Geologist", "C. Astronaut", "D. Chemist"], ans: 1 },
                    { q: "11. How many main layers does the Earth have?", options: ["A. Two", "B. Three", "C. Four", "D. Five"], ans: 2 },
                    { q: "12. The mantle is very", options: ["A. Thick", "B. Thin", "C. Cold", "D. Small"], ans: 0 },
                    { q: "13. Oceans are part of the Earth's", options: ["A. Core", "B. Surface", "C. Mantle", "D. Inner core"], ans: 1 },
                    { q: "14. The inner core is", options: ["A. Liquid", "B. Solid", "C. Gas", "D. Water"], ans: 1 },
                    { q: "15. Rivers flow on the Earth's", options: ["A. Surface", "B. Core", "C. Mantle", "D. Center"], ans: 0 },
                    { q: "16. The big pieces of the crust are called", options: ["A. Plates", "B. Clouds", "C. Waves", "D. Trees"], ans: 0 },
                    { q: "17. Plates move very", options: ["A. Fast", "B. Slowly", "C. Never", "D. Backward"], ans: 1 },
                    { q: "18. Moving plates can cause", options: ["A. Rainbows", "B. Earthquakes", "C. Seasons", "D. Day and night"], ans: 1 },
                    { q: "19. A mountain that erupts lava is a", options: ["A. Hill", "B. Volcano", "C. Valley", "D. Plain"], ans: 1 },
                    { q: "20. Most earthquakes happen near plate", options: ["A. Centers", "B. Boundaries", "C. Rivers", "D. Farm"], ans: 1 },
                    { q: "21. When plates push together, they can form", options: ["A. Rivers", "B. Mountains", "C. Clouds", "D. Lakes"], ans: 1 },
                    { q: "22. When plates move apart, new ocean floor can", options: ["A. Break", "B. Form", "C. Melt", "D. Sink"], ans: 1 },
                    { q: "23. The study of plate movement is called", options: ["A. Biology", "B. Plate Tectonics", "C. Ecology", "D. Astronomy"], ans: 1 },
                    { q: "24. A scientist who studies earthquakes is called a", options: ["A. Seismologist", "B. Dentist", "C. Pilot", "D. Engineer"], ans: 0 },
                    { q: "25. Volcanoes are common near plate", options: ["A. Boundaries", "B. Centers", "C. Lakes", "D. Forests"], ans: 0 },
                    { q: "26. The shaking of the ground is called an", options: ["A. Eruption", "B. Earthquake", "C. Flood", "D. Storm"], ans: 1 },
                    { q: "27. When one plate goes under another, it is called", options: ["A. Subduction", "B. Freezing", "C. Burning", "D. Evaporation"], ans: 0 },
                    { q: "28. Heat inside the Earth causes plates to", options: ["A. Sleep", "B. Move", "C. Stop", "D. Shine"], ans: 1 },
                    { q: "29. The Pacific Ring of Fire has many", options: ["A. Earthquakes and volcanoes", "B. Snowstorms", "C. Rivers", "D. Forests"], ans: 0 },
                    { q: "30. Thailand can experience earthquakes because of moving", options: ["A. Clouds", "B. Plates", "C. Winds", "D. Ice"], ans: 1 }
                ]
            }
        };

        let currentQuiz = null;
        let userAnswers = {};
        let timeLeft = 60 * 60;
        let timerInterval;

        function startQuiz(quizId) {
            currentQuiz = quizData[quizId];
            userAnswers = {};
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('quiz-title').innerText = currentQuiz.title;
            
            const discussionBox = document.getElementById('discussion-box');
            if (currentQuiz.discussion) {
                document.getElementById('discussion-text').innerText = currentQuiz.discussion;
                discussionBox.classList.remove('hidden');
            } else {
                discussionBox.classList.add('hidden');
            }

            renderQuestions();
            timeLeft = 60 * 60;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz();
                }
            }, 1000);
            window.scrollTo(0, 0);
        }

        function exitQuiz() {
            if(confirm("ต้องการออกจากห้องสอบใช่หรือไม่? (ข้อมูลที่ทำไว้จะหายไป)")) {
                clearInterval(timerInterval);
                location.reload();
            }
        }

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';
            currentQuiz.questions.forEach((item, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-white p-8 rounded-2xl shadow-sm border border-gray-100';
                let html = `<p class="font-bold text-xl mb-6 text-slate-800">${item.q}</p>`;
                item.options.forEach((opt, optIndex) => {
                    html += `
                        <label>
                            <input type="radio" name="q${index}" value="${optIndex}" onchange="saveAnswer(${index}, ${optIndex})">
                            <span class="option-label text-gray-700">${opt}</span>
                        </label>`;
                });
                questionDiv.innerHTML = html;
                container.appendChild(questionDiv);
            });
        }

        function saveAnswer(qIndex, optIndex) {
            userAnswers[qIndex] = optIndex;
        }

        function confirmSubmit() {
            const answeredCount = Object.keys(userAnswers).length;
            const total = currentQuiz.questions.length;
            if (answeredCount < total) {
                if(!confirm(`ทำไปเพียง ${answeredCount} จาก ${total} ข้อ ยืนยันจะส่งหรือไม่?`)) return;
            } else {
                if(!confirm('ยืนยันการส่งคำตอบ?')) return;
            }
            submitQuiz();
        }

        function submitQuiz() {
            clearInterval(timerInterval);
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            
            let score = 0;
            const reviewContainer = document.getElementById('review-container');
            reviewContainer.innerHTML = '';

            currentQuiz.questions.forEach((item, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === item.ans;
                if (isCorrect) score++;

                const reviewDiv = document.createElement('div');
                reviewDiv.className = `p-8 rounded-2xl shadow-sm border-l-8 bg-white ${isCorrect ? 'border-green-500' : 'border-red-500'}`;
                
                let reviewHtml = `
                    <div class="font-black text-sm uppercase tracking-widest mb-2 ${isCorrect ? 'text-green-500' : 'text-red-500'}">
                        ${isCorrect ? 'Correct ✓' : 'Incorrect ✗'}
                    </div>
                    <p class="font-bold text-lg mb-4 text-slate-800">${item.q}</p>`;

                item.options.forEach((opt, optIndex) => {
                    let style = "p-3 mb-2 rounded-lg border ";
                    if (optIndex === item.ans) {
                        style += "border-green-500 bg-green-50 text-green-700 font-bold";
                    } else if (optIndex === userAnswer && !isCorrect) {
                        style += "border-red-500 bg-red-50 text-red-700 font-bold line-through";
                    } else {
                        style += "border-gray-100 text-gray-400";
                    }
                    reviewHtml += `<div class="${style}">${opt}</div>`;
                });

                reviewDiv.innerHTML = reviewHtml;
                reviewContainer.appendChild(reviewDiv);
            });

            document.getElementById('score-display').innerText = score;
            document.getElementById('total-display').innerText = currentQuiz.questions.length;
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
