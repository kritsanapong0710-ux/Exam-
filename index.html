<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HP & Arjey Online Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Prompt', sans-serif; background-color: #f8fafc; }
        .option-label {
            display: block; padding: 15px; margin-bottom: 10px;
            background-color: white; border: 2px solid #e2e8f0;
            border-radius: 12px; cursor: pointer; transition: all 0.2s;
        }
        input[type="radio"]:checked + .option-label {
            border-color: #2563eb; background-color: #eff6ff;
            font-weight: 600; color: #1e40af;
        }
        input[type="radio"] { display: none; }
        .discussion-box { line-height: 1.8; }
    </style>
</head>
<body>

    <div id="menu-screen" class="min-h-screen flex items-center justify-center p-6">
        <div class="bg-white p-10 rounded-3xl shadow-2xl max-w-xl w-full border border-gray-100">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-8">ระบบทดสอบออนไลน์</h1>
            <div class="space-y-4">
                <button onclick="startQuiz('hp22102')" class="w-full p-5 bg-blue-600 text-white rounded-2xl font-bold hover:bg-blue-700 transition shadow-lg">HP 22102 (Health & PE)</button>
                <button onclick="startQuiz('arjey1')" class="w-full p-5 bg-emerald-600 text-white rounded-2xl font-bold hover:bg-emerald-700 transition shadow-lg">Arjey 1 (Env & Rocks)</button>
                <button onclick="startQuiz('arjey2')" class="w-full p-5 bg-purple-600 text-white rounded-2xl font-bold hover:bg-purple-700 transition shadow-lg">Arjey 2 (Earth Layers)</button>
            </div>
        </div>
    </div>

    <div id="quiz-screen" class="hidden min-h-screen pb-20">
        <div class="sticky top-0 bg-white shadow-md z-50 px-6 py-4 flex justify-between items-center">
            <div>
                <h2 id="quiz-title" class="text-xl font-bold text-gray-800">Title</h2>
                <div id="timer" class="text-red-600 font-bold">60:00</div>
            </div>
            <button onclick="exitQuiz()" class="bg-red-50 text-red-600 px-4 py-2 rounded-lg font-bold border border-red-200 hover:bg-red-100">Exit Quiz</button>
        </div>

        <div class="max-w-4xl mx-auto px-4 mt-8">
            <div id="discussion-box" class="hidden mb-10 bg-blue-50 border-l-8 border-blue-500 p-8 rounded-xl shadow-sm">
                <h3 class="text-xl font-bold text-blue-900 mb-4 underline">Short Discussion (Study carefully)</h3>
                <div id="discussion-text" class="discussion-box text-gray-800 whitespace-pre-line text-lg"></div>
            </div>

            <div id="questions-container" class="space-y-8"></div>

            <button onclick="confirmSubmit()" class="mt-12 w-full bg-gray-900 text-white font-bold py-5 rounded-2xl shadow-xl hover:bg-black transition-all">Submit Answers</button>
        </div>
    </div>

    <div id="result-screen" class="hidden min-h-screen py-10 px-4">
        <div class="max-w-3xl mx-auto bg-white p-10 rounded-3xl shadow-xl text-center">
            <h2 class="text-2xl font-bold text-gray-500">Your Score</h2>
            <div class="text-7xl font-black text-blue-600 my-6"><span id="score-display">0</span> / <span id="total-display">0</span></div>
            <div id="review-container" class="text-left mt-10 space-y-6"></div>
            <button onclick="location.reload()" class="mt-10 bg-blue-600 text-white px-10 py-3 rounded-full font-bold">Try Again</button>
        </div>
    </div>

    <script>
        const quizData = {
            "hp22102": {
                title: "HP 22102 Review",
                discussion: "Focus on drug rehabilitation types, avoiding risky situations, and emergency response. \n• Mental rehabilitation: Consulting with psychiatrists, religious treatment.\n• Physical rehabilitation: Using herbs, anti-drugs, electric waves.\n• Life Skills: Refusing, Negotiating, Thinking processes, and Self-protection.\n• Emergency numbers: 191 for police/emergency.",
                questions: [
                    { q: "1. Which of the following is not the rehabilitation of drug addicts?", options: ["A. Take care those who have stopped using drugs.", "B. Invite friends who also use drugs before to exercise regularly.", "C. Hang out with drug addicts.", "D. Arrange dancing competition for friends who have stopped using drugs."], ans: 2 },
                    { q: "2. Which factor helps the drug addict stop using drugs permanently?", options: ["A. Doctors and nurses", "B. Drug cartels", "C. Family and oneself", "D. Drug pushers"], ans: 2 },
                    { q: "3. Which of the following is a mental way of drug addicts’ rehabilitation?", options: ["A. Using electric wave", "B. Using methadone", "C. Religious treatment", "D. Using herbs"], ans: 2 },
                    { q: "4. Which one is correct regarding sources of assistance and rehabilitation of drug addicts?", options: ["A. It is the organization that treats many drug addicts.", "B. It is a governmental organization that deals with drug addicts.", "C. It is the organization that provides medical treatment to people.", "D. It is a specific organization for mental treatment."], ans: 1 },
                    { q: "5. Which of the following rehabilitation accepts patients to be treated in the hospital?", options: ["A. In-patient rehabilitation", "B. Out-patient rehabilitation", "C. Taking action and following up the result", "D. Analyzing the cause of addiction."], ans: 0 },
                    { q: "6. Which of the following is not a physical rehabilitation of drug addicts?", options: ["A. Religious Treatment", "B. Using anti-drugs", "C. Using herbs as a medicine", "D. Using electric wave"], ans: 0 },
                    { q: "7. If a drug addict captures you as a hostage, what should you do?", options: ["A. Blame the drug addict with cruel words", "B. Persuade the drug addict", "C. Fight as much as possible", "D. Shout for help from those around the area"], ans: 1 },
                    { q: "8. Which is not a stage of the treatment of drug addicts as an out-patient of the Ministry of Public Health?", options: ["A. Preparing stage", "B. Drug-activating stage", "C. Rehabilitation Stage", "D. Following-up stage"], ans: 1 },
                    { q: "9. Which one is the mental treatment for drug addicts?", options: ["A. Consulting with psychiatrist.", "B. Using medicine to stimulate nervous system.", "C. Maintaining drugs.", "D. Using anti-drugs medicine"], ans: 0 },
                    { q: "10. Which of the following is the right way to treat drug addicts?", options: ["A. Seeing the doctor regularly.", "B. Reducing the number of drugs but still using drugs every day.", "C. Stop seeing the doctor after using drugs in the beginning stage.", "D. Trying to stop using drugs by taking medicine."], ans: 0 },
                    { q: "11. Who creates the value of oneself after the treatment regarding drug addiction?", options: ["A. Areeya stays at home because she feels embarrassed", "B. Krittika applies for a job as a waitress in the restaurant", "C. Sirima blames herself for using drugs", "D. Nut hangs out with drug addicts"], ans: 1 },
                    { q: "12. What is the old way of treating drug addicts?", options: ["A. Psychiatrist", "B. Herb", "C. Electric wave", "D. Group Activity"], ans: 1 },
                    { q: "13. Which of the following has a relationship with the treatment of out-patients at the Ministry of Public Health?", options: ["A. Treating at the institution and staying there.", "B. Appointing patients to receive medicine.", "C. Being a regular patient in the hospital.", "D. Joining the activities of the institution all the time."], ans: 1 },
                    { q: "14. What should you do to avoid vices?", options: ["A. Racing with friends", "B. Hanging out with gamblers", "C. Watching friends gambling", "D. Refusing/stop hanging out with gamblers"], ans: 3 },
                    { q: "15. Which one is the use of life skills in daily life?", options: ["A. Acting according to your own satisfaction", "B. Being pessimistic", "C. Hanging out with those who have high education", "D. Knowing what you are doing"], ans: 3 },
                    { q: "16. Which one is not a risk situation?", options: ["A. Racing motorcycle on the road at night", "B. Travelling alone at night", "C. Hanging out with seniors and bad people", "D. Applying for football competition at school"], ans: 3 },
                    { q: "17. When being forced or raped by somebody, what is the right thing to do?", options: ["A. Stay away", "B. Try to postpone the time by talking nicely and gently.", "C. Shout very loud", "D. Run as fast as you can"], ans: 1 },
                    { q: "18. How to avoid being robbed?", options: ["A. Immediately call a friend.", "B. Do not walk alone in dangerous places.", "C. Wear expensive jewelries.", "D. Show your money to everyone"], ans: 1 },
                    { q: "19. What is the first step of the thinking process in living life?", options: ["A. Analyzing the cause of the problem", "B. Collecting data for making a decision", "C. Taking action and following-up the result", "D. Conclusion and evaluation"], ans: 0 },
                    { q: "20. Which behavior might lead to sexual intercourse the most?", options: ["A. Being alone with the opposite sex", "B. Having the opposite sex as a friend", "C. Sexy dressing", "D. Allowing the opposite sex to touch the body"], ans: 3 },
                    { q: "21. What is the condition or situation that one is facing at a certain moment?", options: ["A. Emergency Situation", "B. Good Health", "C. Holidays", "D. Stressful"], ans: 0 },
                    { q: "22. Which of the following is the effect of fighting?", options: ["A. Warm family", "B. Unity", "C. Hurting", "D. Educational institution loses reputation"], ans: 2 },
                    { q: "23. Which behavior might lead to having an accident the most?", options: ["A. Wearing a helmet while riding a motorcycle", "B. Limiting speed while driving", "C. Driving even when drunk", "D. Stopping the car when seeing a red-light"], ans: 2 },
                    { q: "24. Improving personality that causes confidence can be done by _____________.", options: ["A. Carrying a lot of money", "B. No exercise", "C. Assessing of feelings", "D. Dressing appropriately"], ans: 3 },
                    { q: "25. Which of the following is not a cause of fighting?", options: ["A. Wanting to win", "B. Jealousy and vengeance", "C. Conflict of interests", "D. Humility and forgiveness"], ans: 3 },
                    { q: "26. It means knowing the event that will happen in the future.", options: ["A. Prediction", "B. Life skills", "C. Negotiation", "D. Thinking Process"], ans: 0 },
                    { q: "27. It means talking in order to improve the situation or to avoid the risk situation.", options: ["A. Negotiation", "B. Thinking Process", "C. Prediction", "D. Life Skills"], ans: 0 },
                    { q: "28. Which emergency situation causes the loss of life and property?", options: ["A. Robbery", "B. Falling off a motorcycle", "C. Fire burning", "D. Exhausted after exercising"], ans: 2 },
                    { q: "29. Which one is the right thing to do during emergency situation?", options: ["A. Frightening and shouting", "B. Keeping valuable stuff as much as possible", "C. Concentrating and finding the ways to solve problem", "D. Fighting with the criminal"], ans: 2 },
                    { q: "30. The skill that helps in protecting oneself from danger in order to stop the criminal.", options: ["A. Negotiation", "B. Natural Disaster", "C. Refusing", "D. Self-protection"], ans: 3 },
                    { q: "31. A skill that can be used in daily life situation to avoid use of drugs, gambling and having sexual intercourse.", options: ["A. Forecasting", "B. Happenings", "C. Warning sign", "D. Refusing"], ans: 3 },
                    { q: "32. What should you do during earthquake?", options: ["A. Watch television", "B. Drive a car", "C. Use the elevator", "D. Stay away from a building"], ans: 3 },
                    { q: "33. Which is the most convenient and easiest way in order to ask for help during an emergency situation?", options: ["A. Send a text message through a mobile phone", "B. By shouting", "C. Run", "D. Write a message"], ans: 1 },
                    { q: "34. If you are in the storm, what should you do?", options: ["A. Run as fast as you can", "B. Hide in a strong and secure place.", "C. Hide under a big tree", "D. Stay outdoors"], ans: 1 },
                    { q: "35. If you need to fight with a criminal, what part of his body will you attack?", options: ["A. Knee", "B. Occipital bone", "C. Brachium", "D. Foot"], ans: 0 },
                    { q: "36. What is the right thing to do when going to the waterfall?", options: ["A. Being in the deep water", "B. Being in the water area that other people do not go", "C. Getting out of the water when the water changes color", "D. Being in the water while raining"], ans: 2 },
                    { q: "37. If you are captured as a hostage, what should you do first?", options: ["A. Fight back with the criminal", "B. Wait for the police help", "C. Negotiation with nice and gentle words", "D. Resist"], ans: 2 },
                    { q: "38. Which place is at risk for being robbed?", options: ["A. The fresh market", "B. The park", "C. The department store", "D. An isolated place"], ans: 3 },
                    { q: "39. If you cannot solve an emergency situation, what will you do?", options: ["A. Call your parents", "B. Call your friends", "C. Call the school", "D. Call 191"], ans: 3 },
                    { q: "40. Which one is not a life skill for preventing and avoiding an emergency situation?", options: ["A. Refusing", "B. Negotiation", "C. Exercising", "D. Self-protection"], ans: 2 }
                ]
            },
            "arjey1": {
                title: "Arjey 1: Module 12 & 13",
                discussion: "Module 12: The Environment-Land, Water, and Air\nThe environment includes land, water, air, and living things. We need clean air and clean water to live. Pollution can harm the environment. The air around Earth is called the Atmosphere. All water on Earth is called the Hydrosphere. Living things are part of the Biosphere. The study of the environment is called Environmental Science.\n\nModule 13: Minerals and Rocks\nMinerals are natural solid materials found in the Earth. Rocks are made of minerals. There are three main types of rocks: \n1. Igneous: form from cooled magma. \n2. Sedimentary: made from small pieces called sediments. \n3. Metamorphic: change because of heat and pressure. \nThe study of minerals is called Mineralogy, and the study of rocks is called Petrology.",
                questions: [
                    { q: "1. The air around Earth is called the", options: ["A. Atmosphere", "B. Core", "C. Mantle", "D. Plate"], ans: 0 },
                    { q: "2. All water on Earth is called the", options: ["A. Atmosphere", "B. Hydrosphere", "C. Lithosphere", "D. Core"], ans: 1 },
                    { q: "3. Living things are part of the", options: ["A. Biosphere", "B. Core", "C. Mantle", "D. Plate"], ans: 0 },
                    { q: "4. Plants grow in", options: ["A. Soil", "B. Fire", "C. Metal", "D. Air"], ans: 0 },
                    { q: "5. Dirty air and water are examples of", options: ["A. Energy", "B. Pollution", "C. Weather", "D. Gas"], ans: 1 },
                    { q: "6. The study of the environment is called", options: ["A. Geology", "B. Environmental Science", "C. Astronomy", "D. Physics"], ans: 1 },
                    { q: "7. A person who studies the environment is called an", options: ["A. Environmental scientist", "B. Pilot", "C. Mechanic", "D. Chef"], ans: 0 },
                    { q: "8. Recycling helps reduce", options: ["A. Waste", "B. Oxygen", "C. Rain", "D. Rocks"], ans: 0 },
                    { q: "9. Too much greenhouse gas can cause", options: ["A. Global warming", "B. Snow", "C. Wind", "D. Earthquakes"], ans: 0 },
                    { q: "10. The ozone layer protects us from strong", options: ["A. UV rays", "B. Rain", "C. Snow", "D. Sand"], ans: 0 },
                    { q: "11. Rivers and lakes contain _______ water.", options: ["A. Salt", "B. Fresh", "C. Dirty", "D. Hot"], ans: 1 },
                    { q: "12. Cutting many trees is called", options: ["A. Planting", "B. Recycling", "C. Deforestation", "D. Cleaning"], ans: 2 },
                    { q: "13. Clean water is important for", options: ["A. Drinking", "B. Burning", "C. Melting", "D. Breaking"], ans: 0 },
                    { q: "14. Taking care of the environment is the job of", options: ["A. Scientists only", "B. Everyone", "C. Teachers only", "D. No one"], ans: 1 },
                    { q: "15. The water cycle includes rain and", options: ["A. Condensation", "B. Burning", "C. Freezing", "D. Cutting"], ans: 0 },
                    { q: "16. A mineral is a natural", options: ["A. Solid", "B. Liquid", "C. Gas", "D. Animal"], ans: 0 },
                    { q: "17. Rocks are made of", options: ["A. Minerals", "B. Water", "C. Air", "D. Clouds"], ans: 0 },
                    { q: "18. The study of minerals is called", options: ["A. Mineralogy", "B. Biology", "C. Ecology", "D. Astronomy"], ans: 0 },
                    { q: "19. The study of rocks is called", options: ["A. Petrology", "B. Zoology", "C. Botany", "D. Meteorology"], ans: 0 },
                    { q: "20. Igneous rocks form from cooled", options: ["A. Magma", "B. Water", "C. Soil", "D. Ice"], ans: 0 },
                    { q: "21. Sedimentary rocks are made from small pieces called", options: ["A. Sediments", "B. Waves", "C. Clouds", "D. Crystals"], ans: 0 },
                    { q: "22. Metamorphic rocks change because of heat and", options: ["A. Rain", "B. Pressure", "C. Wind", "D. Ice"], ans: 1 },
                    { q: "23. Granite is an example of an _______ rock", options: ["A. Igneous", "B. Sedimentary", "C. Liquid", "D. Soft"], ans: 0 },
                    { q: "24. Marble is a rock", options: ["A. Igneous", "B. Sedimentary", "C. Metamorphic", "D. Gas"], ans: 2 },
                    { q: "25. The Mohs scale measures mineral", options: ["A. Color", "B. Hardness", "C. Size", "D. Shape"], ans: 1 },
                    { q: "26. Breaking rocks into small pieces is called", options: ["A. Weathering", "B. Melting", "C. Burning", "D. Cooling"], ans: 0 },
                    { q: "27. Moving rocks by wind or water is called", options: ["A. Erosion", "B. Freezing", "C. Heating", "D. Pressing"], ans: 0 },
                    { q: "28. The rock cycle shows how rocks", options: ["A. Change", "B. Sleep", "C. Shine", "D. Float"], ans: 0 },
                    { q: "29. Fossils are usually found in rocks", options: ["A. Sedimentary", "B. Igneous", "C. Melted", "D. Liquid"], ans: 0 },
                    { q: "30. Both mineralogy and petrology are part of", options: ["A. Biology", "B. Geology", "C. Astronomy", "D. Physics"], ans: 1 }
                ]
            },
            "arjey2": {
                title: "Arjey 2: Module 10 & 11",
                discussion: "Module 10: Earth's Layers and Surface\nThe Earth has four main layers: crust, mantle, outer core, and inner core. We live on the crust. The mantle is thick and hot. The outer core is liquid metal, and the inner core is solid and very hot. The Earth's surface has mountains, rivers, oceans, and plains. The study of the Earth and its layers is called Geology.\n\nModule 11: Plate Tectonics\nThe Earth's crust is broken into large plates. These plates move slowly. When they move, they can cause earthquakes and volcanoes. One plate goes under another is called subduction. The Pacific Ring of Fire has many earthquakes and volcanoes. The study of plate movement is called Plate Tectonics.",
                questions: [
                    { q: "1. Which layer do we live on?", options: ["A. Crust", "B. Mantle", "C. Core", "D. Inner core"], ans: 0 },
                    { q: "2. Which is the thickest layer of the Earth?", options: ["A. Crust", "B. Mantle", "C. Ocean", "D. Sky"], ans: 1 },
                    { q: "3. What is the center of the Earth called?", options: ["A. Crust", "B. Mantle", "C. Core", "D. Soil"], ans: 2 },
                    { q: "4. The outer core is", options: ["A. Solid", "B. Liquid", "C. Cold", "D. Air"], ans: 1 },
                    { q: "5. The inner core is very", options: ["A. Cold", "B. Hot", "C. Soft", "D. Wet"], ans: 1 },
                    { q: "6. The crust is broken into big pieces called", options: ["A. Plates", "B. Clouds", "C. Trees", "D. Waves"], ans: 0 },
                    { q: "7. Mountains are found on the Earth's", options: ["A. Core", "B. Surface", "C. Mantle", "D. Center"], ans: 1 },
                    { q: "8. As we go deeper inside the Earth, it gets", options: ["A. Colder", "B. Hotter", "C. Lighter", "D. Smaller"], ans: 1 },
                    { q: "9. The study of the Earth and its layers is called", options: ["A. Biology", "B. Geology", "C. Astronomy", "D. Chemistry"], ans: 1 },
                    { q: "10. A scientist who studies the Earth is called a", options: ["A. Biologist", "B. Geologist", "C. Astronaut", "D. Chemist"], ans: 1 },
                    { q: "11. How many main layers does the Earth have?", options: ["A. Two", "B. Three", "C. Four", "D. Five"], ans: 2 },
                    { q: "12. The mantle is very", options: ["A. Thick", "B. Thin", "C. Cold", "D. Small"], ans: 0 },
                    { q: "13. Oceans are part of the Earth's", options: ["A. Core", "B. Surface", "C. Mantle", "D. Inner core"], ans: 1 },
                    { q: "14. The inner core is", options: ["A. Liquid", "B. Solid", "C. Gas", "D. Water"], ans: 1 },
                    { q: "15. Rivers flow on the Earth's", options: ["A. Surface", "B. Core", "C. Mantle", "D. Center"], ans: 0 },
                    { q: "16. The big pieces of the crust are called", options: ["A. Plates", "B. Clouds", "C. Waves", "D. Trees"], ans: 0 },
                    { q: "17. Plates move very", options: ["A. Fast", "B. Slowly", "C. Never", "D. Backward"], ans: 1 },
                    { q: "18. Moving plates can cause", options: ["A. Rainbows", "B. Earthquakes", "C. Seasons", "D. Day and night"], ans: 1 },
                    { q: "19. A mountain that erupts lava is a", options: ["A. Hill", "B. Volcano", "C. Valley", "D. Plain"], ans: 1 },
                    { q: "20. Most earthquakes happen near plate", options: ["A. Centers", "B. Boundaries", "C. Rivers", "D. Farm"], ans: 1 },
                    { q: "21. When plates push together, they can form", options: ["A. Rivers", "B. Mountains", "C. Clouds", "D. Lakes"], ans: 1 },
                    { q: "22. When plates move apart, new ocean floor can", options: ["A. Break", "B. Form", "C. Melt", "D. Sink"], ans: 1 },
                    { q: "23. The study of plate movement is called", options: ["A. Biology", "B. Plate Tectonics", "C. Ecology", "D. Astronomy"], ans: 1 },
                    { q: "24. A scientist who studies earthquakes is called a", options: ["A. Seismologist", "B. Dentist", "C. Pilot", "D. Engineer"], ans: 0 },
                    { q: "25. Volcanoes are common near plate", options: ["A. Boundaries", "B. Centers", "C. Lakes", "D. Forests"], ans: 0 },
                    { q: "26. The shaking of the ground is called an", options: ["A. Eruption", "B. Earthquake", "C. Flood", "D. Storm"], ans: 1 },
                    { q: "27. When one plate goes under another, it is called", options: ["A. Subduction", "B. Freezing", "C. Burning", "D. Evaporation"], ans: 0 },
                    { q: "28. Heat inside the Earth causes plates to", options: ["A. Sleep", "B. Move", "C. Stop", "D. Shine"], ans: 1 },
                    { q: "29. The Pacific Ring of Fire has many", options: ["A. Earthquakes and volcanoes", "B. Snowstorms", "C. Rivers", "D. Forests"], ans: 0 },
                    { q: "30. Thailand can experience earthquakes because of moving", options: ["A. Clouds", "B. Plates", "C. Winds", "D. Ice"], ans: 1 }
                ]
            }
        };

        let currentQuiz = null;
        let userAnswers = {};
        let timeLeft = 60 * 60;
        let timerInterval;

        function startQuiz(quizId) {
            currentQuiz = quizData[quizId];
            userAnswers = {};
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('quiz-title').innerText = currentQuiz.title;
            
            const dbText = document.getElementById('discussion-text');
            const dbBox = document.getElementById('discussion-box');
            if (currentQuiz.discussion) {
                dbText.innerText = currentQuiz.discussion;
                dbBox.classList.remove('hidden');
            } else {
                dbBox.classList.add('hidden');
            }

            renderQuestions();
            timeLeft = 60 * 60;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert("Time is up!");
                    submitQuiz();
                }
            }, 1000);
            window.scrollTo(0, 0);
        }

        function exitQuiz() {
            if(confirm("Are you sure you want to exit? Your progress will be lost.")) {
                clearInterval(timerInterval);
                location.reload();
            }
        }

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';
            currentQuiz.questions.forEach((item, index) => {
                const qDiv = document.createElement('div');
                qDiv.className = 'bg-white p-6 rounded-2xl shadow-sm border border-gray-100';
                let html = `<p class="font-bold text-lg mb-4">${item.q}</p>`;
                item.options.forEach((opt, optIndex) => {
                    html += `<label>
                        <input type="radio" name="q${index}" value="${optIndex}" onchange="saveAnswer(${index}, ${optIndex})">
                        <span class="option-label">${opt}</span>
                    </label>`;
                });
                qDiv.innerHTML = html;
                container.appendChild(qDiv);
            });
        }

        function saveAnswer(q, a) { userAnswers[q] = a; }

        function confirmSubmit() {
            if(confirm("Submit your answers?")) submitQuiz();
        }

        function submitQuiz() {
            clearInterval(timerInterval);
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            let score = 0;
            const container = document.getElementById('review-container');
            container.innerHTML = '';

            currentQuiz.questions.forEach((item, index) => {
                const isCorrect = userAnswers[index] === item.ans;
                if(isCorrect) score++;
                
                const div = document.createElement('div');
                div.className = `p-5 rounded-xl border-l-4 ${isCorrect ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50'}`;
                let h = `<p class="font-bold mb-2">${item.q}</p>`;
                item.options.forEach((o, i) => {
                    let c = "text-gray-500";
                    if(i === item.ans) c = "text-green-700 font-bold underline";
                    if(i === userAnswers[index] && !isCorrect) c = "text-red-700 font-bold line-through";
                    h += `<div class="text-sm ${c}">${o}</div>`;
                });
                div.innerHTML = h;
                container.appendChild(div);
            });
            document.getElementById('score-display').innerText = score;
            document.getElementById('total-display').innerText = currentQuiz.questions.length;
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
