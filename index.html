<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบทดสอบออนไลน์</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Prompt', sans-serif; background-color: #f3f4f6; }
        
        /* ตกแต่ง Radio Button ให้เป็นปุ่มกดสวยๆ */
        .option-label {
            display: block;
            padding: 12px 16px;
            margin-bottom: 8px;
            background-color: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .option-label:hover { border-color: #9ca3af; }
        input[type="radio"]:checked + .option-label {
            border-color: #3b82f6;
            background-color: #eff6ff;
            font-weight: 500;
            color: #1d4ed8;
        }
        input[type="radio"] { display: none; }

        /* สีสำหรับเฉลย */
        .correct-answer { border-color: #22c55e !important; background-color: #f0fdf4 !important; color: #15803d !important; }
        .wrong-answer { border-color: #ef4444 !important; background-color: #fef2f2 !important; color: #b91c1c !important; }
    </style>
</head>
<body class="text-gray-800">

    <div id="menu-screen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white p-8 rounded-2xl shadow-lg max-w-2xl w-full text-center">
            <h1 class="text-3xl font-bold text-blue-600 mb-2">ระบบทดสอบออนไลน์</h1>
            <p class="text-gray-500 mb-8">เลือกรายวิชาที่คุณต้องการทดสอบ (เวลาทำข้อสอบ 60 นาที)</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <button onclick="startQuiz('hp22102')" class="p-6 border-2 border-blue-100 rounded-xl hover:bg-blue-50 hover:border-blue-300 transition-all group">
                    <h2 class="text-xl font-semibold text-gray-700 group-hover:text-blue-600">HP 22102</h2>
                    <p class="text-sm text-gray-400 mt-2">Health & PE</p>
                </button>
                <button onclick="startQuiz('arjey1')" class="p-6 border-2 border-green-100 rounded-xl hover:bg-green-50 hover:border-green-300 transition-all group">
                    <h2 class="text-xl font-semibold text-gray-700 group-hover:text-green-600">Pretest Arjey 1</h2>
                    <p class="text-sm text-gray-400 mt-2">Environment & Minerals</p>
                </button>
                <button onclick="startQuiz('arjey2')" class="p-6 border-2 border-purple-100 rounded-xl hover:bg-purple-50 hover:border-purple-300 transition-all group">
                    <h2 class="text-xl font-semibold text-gray-700 group-hover:text-purple-600">Pretest Arjey 2</h2>
                    <p class="text-sm text-gray-400 mt-2">Earth's Layers & Tectonics</p>
                </button>
            </div>
        </div>
    </div>

    <div id="quiz-screen" class="hidden min-h-screen pb-20">
        <div class="sticky top-0 bg-white shadow-md z-50 px-4 py-3 flex justify-between items-center">
            <h1 id="quiz-title" class="text-lg md:text-xl font-bold text-gray-800">ชื่อวิชา</h1>
            <div class="flex items-center space-x-2 bg-red-100 px-4 py-2 rounded-full text-red-600 font-bold">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
                </svg>
                <span id="timer">60:00</span>
            </div>
        </div>

        <div class="max-w-3xl mx-auto mt-6 px-4">
            <div id="discussion-box" class="hidden mb-8 bg-blue-50 border-l-4 border-blue-500 p-6 rounded-r-lg shadow-sm">
                <h3 class="text-lg font-bold text-blue-800 mb-2">Short Discussion</h3>
                <div id="discussion-text" class="text-gray-700 text-sm md:text-base whitespace-pre-line leading-relaxed"></div>
            </div>

            <div id="questions-container" class="space-y-8"></div>

            <button onclick="confirmSubmit()" id="submit-btn" class="mt-10 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition-all text-lg">
                ส่งคำตอบและตรวจข้อสอบ
            </button>
        </div>
    </div>

    <div id="result-screen" class="hidden min-h-screen py-10 px-4">
        <div class="max-w-3xl mx-auto">
            <div class="bg-white p-8 rounded-2xl shadow-lg text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">สรุปผลคะแนน</h2>
                <div class="text-6xl font-black text-blue-600 my-4"><span id="score-display">0</span> / <span id="total-display">0</span></div>
                <p class="text-gray-500">ทบทวนข้อที่ผิดและถูกได้ด้านล่าง</p>
                <button onclick="location.reload()" class="mt-6 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-6 rounded-lg transition-all">กลับหน้าหลัก</button>
            </div>
            
            <div id="review-container" class="space-y-6"></div>
        </div>
    </div>

    <script>
        // ฐานข้อมูลข้อสอบ
        // ans: 0=A, 1=B, 2=C, 3=D
        const quizData = {
            "hp22102": {
                title: "HP 22102 (Review)",
                discussion: null,
                questions: [
                    { q: "1. Which of the following is not the rehabilitation of drug addicts?", options: ["A. Take care those who have stopped using drugs.", "B. Invite friends who also use drugs before to exercise regularly.", "C. Hang out with drug addicts.", "D. Arrange dancing competition for friends who have stopped using drugs."], ans: 2 },
                    { q: "2. Which factor helps the drug addict stop using drugs permanently?", options: ["A. Doctors and nurses", "B. Drug cartels", "C. Family and oneself", "D. Drug pushers"], ans: 2 },
                    { q: "3. Which of the following is a mental way of drug addicts’ rehabilitation?", options: ["A. Using electric wave", "B. Using methadone", "C. Religious treatment", "D. Using herbs"], ans: 2 },
                    { q: "4. Which one is correct regarding sources of assistance and rehabilitation of drug addicts?", options: ["A. It is the organization that treats many drug addicts.", "B. It is a governmental organization that deals with drug addicts.", "C. It is the organization that provides medical treatment to people.", "D. It is a specific organization for mental treatment."], ans: 1 },
                    { q: "5. Which of the following rehabilitation accepts patients to be treated in the hospital?", options: ["A. In-patient rehabilitation", "B. Out-patient rehabilitation", "C. Taking action and following up the result", "D. Analyzing the cause of addiction."], ans: 0 },
                    { q: "6. Which of the following is not a physical rehabilitation of drug addicts?", options: ["A. Religious Treatment", "B. Using anti-drugs", "C. Using herbs as a medicine", "D. Using electric wave"], ans: 0 },
                    { q: "7. If a drug addict captures you as a hostage, what should you do?", options: ["A. Blame the drug addict with cruel words", "B. Persuade the drug addict", "C. Fight as much as possible", "D. Shout for help from those around the area"], ans: 1 },
                    { q: "8. Which is not a stage of the treatment of drug addicts as an out-patient of the Ministry of Public Health?", options: ["A. Preparing stage", "B. Drug-activating stage", "C. Rehabilitation Stage", "D. Following-up stage"], ans: 1 },
                    { q: "9. Which one is the mental treatment for drug addicts?", options: ["A. Consulting with psychiatrist.", "B. Using medicine to stimulate nervous system.", "C. Maintaining drugs.", "D. Using anti-drugs medicine"], ans: 0 },
                    { q: "10. Which of the following is the right way to treat drug addicts?", options: ["A. Seeing the doctor regularly.", "B. Reducing the number of drugs but still using drugs every day.", "C. Stop seeing the doctor after using drugs in the beginning stage.", "D. Trying to stop using drugs by taking medicine."], ans: 0 },
                    { q: "11. Who creates the value of oneself after the treatment regarding drug addiction?", options: ["A. Areeya stays at home because she feels embarrassed", "B. Krittika applies for a job as a waitress in the restaurant", "C. Sirima blames herself for using drugs", "D. Nut hangs out with drug addicts"], ans: 1 },
                    { q: "12. What is the old way of treating drug addicts?", options: ["A. Psychiatrist", "B. Herb", "C. Electric wave", "D. Group Activity"], ans: 1 },
                    { q: "13. Which of the following has a relationship with the treatment of out-patients at the Ministry of Public Health?", options: ["A. Treating at the institution and staying there.", "B. Appointing patients to receive medicine.", "C. Being a regular patient in the hospital.", "D. Joining the activities of the institution all the time."], ans: 1 },
                    { q: "14. What should you do to avoid vices?", options: ["A. Racing with friends", "B. Hanging out with gamblers", "C. Watching friends gambling", "D. Refusing/stop hanging out with gamblers"], ans: 3 },
                    { q: "15. Which one is the use of life skills in daily life?", options: ["A. Acting according to your own satisfaction", "B. Being pessimistic", "C. Hanging out with those who have high education", "D. Knowing what you are doing"], ans: 3 },
                    { q: "16. Which one is not a risk situation?", options: ["A. Racing motorcycle on the road at night", "B. Travelling alone at night", "C. Hanging out with seniors and bad people", "D. Applying for football competition at school"], ans: 3 },
                    { q: "17. When being forced or raped by somebody, what is the right thing to do?", options: ["A. Stay away", "B. Try to postpone the time by talking nicely and gently.", "C. Shout very loud", "D. Run as fast as you can"], ans: 1 },
                    { q: "18. How to avoid being robbed?", options: ["A. Immediately call a friend.", "B. Do not walk alone in dangerous places.", "C. Wear expensive jewelries.", "D. Show your money to everyone"], ans: 1 },
                    { q: "19. What is the first step of the thinking process in living life?", options: ["A. Analyzing the cause of the problem", "B. Collecting data for making a decision", "C. Taking action and following-up the result", "D. Conclusion and evaluation"], ans: 0 },
                    { q: "20. Which behavior might lead to sexual intercourse the most?", options: ["A. Being alone with the opposite sex", "B. Having the opposite sex as a friend", "C. Sexy dressing", "D. Allowing the opposite sex to touch the body"], ans: 3 },
                    { q: "21. What is the condition or situation that one is facing at a certain moment?", options: ["A. Emergency Situation", "B. Good Health", "C. Holidays", "D. Stressful"], ans: 0 },
                    { q: "22. Which of the following is the effect of fighting?", options: ["A. Warm family", "B. Unity", "C. Hurting", "D. Educational institution loses reputation"], ans: 2 },
                    { q: "23. Which behavior might lead to having an accident the most?", options: ["A. Wearing a helmet while riding a motorcycle", "B. Limiting speed while driving", "C. Driving even when drunk", "D. Stopping the car when seeing a red-light"], ans: 2 },
                    { q: "24. Improving personality that causes confidence can be done by _____________.", options: ["A. Carrying a lot of money", "B. No exercise", "C. Assessing of feelings", "D. Dressing appropriately"], ans: 3 },
                    { q: "25. Which of the following is not a cause of fighting?", options: ["A. Wanting to win", "B. Jealousy and vengeance", "C. Conflict of interests", "D. Humility and forgiveness"], ans: 3 },
                    { q: "26. It means knowing the event that will happen in the future.", options: ["A. Prediction", "B. Life skills", "C. Negotiation", "D. Thinking Process"], ans: 0 },
                    { q: "27. It means talking in order to improve the situation or to avoid the risk situation.", options: ["A. Negotiation", "B. Thinking Process", "C. Prediction", "D. Life Skills"], ans: 0 },
                    { q: "28. Which emergency situation causes the loss of life and property?", options: ["A. Robbery", "B. Falling off a motorcycle", "C. Fire burning", "D. Exhausted after exercising"], ans: 2 },
                    { q: "29. Which one is the right thing to do during emergency situation?", options: ["A. Frightening and shouting", "B. Keeping valuable stuff as much as possible", "C. Concentrating and finding the ways to solve problem", "D. Fighting with the criminal"], ans: 2 },
                    { q: "30. The skill that helps in protecting oneself from danger in order to stop the criminal.", options: ["A. Negotiation", "B. Natural Disaster", "C. Refusing", "D. Self-protection"], ans: 3 },
                    { q: "31. A skill that can be used in daily life situation to avoid use of drugs, gambling and having sexual intercourse.", options: ["A. Forecasting", "B. Happenings", "C. Warning sign", "D. Refusing"], ans: 3 },
                    { q: "32. What should you do during earthquake?", options: ["A. Watch television", "B. Drive a car", "C. Use the elevator", "D. Stay away from a building"], ans: 3 },
                    { q: "33. Which is the most convenient and easiest way in order to ask for help during an emergency situation?", options: ["A. Send a text message through a mobile phone", "B. By shouting", "C. Run", "D. Write a message"], ans: 1 },
                    { q: "34. If you are in the storm, what should you do?", options: ["A. Run as fast as you can", "B. Hide in a strong and secure place.", "C. Hide under a big tree", "D. Stay outdoors"], ans: 1 },
                    { q: "35. If you need to fight with a criminal, what part of his body will you attack?", options: ["A. Knee", "B. Occipital bone", "C. Brachium", "D. Foot (Food)"], ans: 0 },
                    { q: "36. What is the right thing to do when going to the waterfall?", options: ["A. Being in the deep water", "B. Being in the water area that other people do not go in order to escape chaos.", "C. Getting out of the water when the water changes color", "D. Being in the water while raining"], ans: 2 },
                    { q: "37. If you are captured as a hostage, what should you do first?", options: ["A. Fight back with the criminal", "B. Wait for the police help", "C. Negotiation with nice and gentle words", "D. Resist"], ans: 2 },
                    { q: "38. Which place is at risk for being robbed?", options: ["A. The fresh market", "B. The park", "C. The department store", "D. An isolated place"], ans: 3 },
                    { q: "39. If you cannot solve an emergency situation, what will you do?", options: ["A. Call your parents", "B. Call your friends", "C. Call the school", "D. Call 191"], ans: 3 },
                    { q: "40. Which one is not a life skill for preventing and avoiding an emergency situation?", options: ["A. Refusing", "B. Negotiation", "C. Exercising", "D. Self-protection"], ans: 2 }
                ]
            },
            "arjey1": {
                title: "Pretest arjey1",
                discussion: "Module 12: The Environment-Land, Water, and Air\nThe environment includes land, water, air, and living things. We need clean air and clean water to live. Pollution can harm the environment. The study of the environment is called Environmental Science.\n\nModule 13: Minerals and Rocks\nMinerals are natural solid materials found in the Earth. Rocks are made of minerals. There are three main types of rocks: igneous, sedimentary, and metamorphic. The study of minerals is called Mineralogy, and the study of rocks is called Petrology.",
                questions: [
                    { q: "1. The air around Earth is called the", options: ["A. Atmosphere", "B. Core", "C. Mantle", "D. Plate"], ans: 0 },
                    { q: "2. All water on Earth is called the", options: ["A. Atmosphere", "B. Hydrosphere", "C. Lithosphere", "D. Core"], ans: 1 },
                    { q: "3. Living things are part of the", options: ["A. Biosphere", "B. Core", "C. Mantle", "D. Plate"], ans: 0 },
                    { q: "4. Plants grow in", options: ["A. Soil", "B. Fire", "C. Metal", "D. Air"], ans: 0 },
                    { q: "5. Dirty air and water are examples of", options: ["A. Energy", "B. Pollution", "C. Weather", "D. Gas"], ans: 1 },
                    { q: "6. The study of the environment is called", options: ["A. Geology", "B. Environmental Science", "C. Astronomy", "D. Physics"], ans: 1 },
                    { q: "7. A person who studies the environment is called an", options: ["A. Environmental scientist", "B. Pilot", "C. Mechanic", "D. Chef"], ans: 0 },
                    { q: "8. Recycling helps reduce", options: ["A. Waste", "B. Oxygen", "C. Rain", "D. Rocks"], ans: 0 },
                    { q: "9. Too much greenhouse gas can cause", options: ["A. Global warming", "B. Snow", "C. Wind", "D. Earthquakes"], ans: 0 },
                    { q: "10. The ozone layer protects us from strong", options: ["A. UV rays", "B. Rain", "C. Snow", "D. Sand"], ans: 0 },
                    { q: "11. Rivers and lakes contain _______ water.", options: ["A. Salt", "B. Fresh", "C. Dirty", "D. Hot"], ans: 1 },
                    { q: "12. Cutting many trees is called", options: ["A. Planting", "B. Recycling", "C. Deforestation", "D. Cleaning"], ans: 2 },
                    { q: "13. Clean water is important for", options: ["A. Drinking", "B. Burning", "C. Melting", "D. Breaking"], ans: 0 },
                    { q: "14. Taking care of the environment is the job of", options: ["A. Scientists only", "B. Everyone", "C. Teachers only", "D. No one"], ans: 1 },
                    { q: "15. The water cycle includes rain and", options: ["A. Condensation", "B. Burning", "C. Freezing", "D. Cutting"], ans: 0 },
                    { q: "16. A mineral is a natural", options: ["A. Solid", "B. Liquid", "C. Gas", "D. Animal"], ans: 0 },
                    { q: "17. Rocks are made of", options: ["A. Minerals", "B. Water", "C. Air", "D. Clouds"], ans: 0 },
                    { q: "18. The study of minerals is called", options: ["A. Mineralogy", "B. Biology", "C. Ecology", "D. Astronomy"], ans: 0 },
                    { q: "19. The study of rocks is called", options: ["A. Petrology", "B. Zoology", "C. Botany", "D. Meteorology"], ans: 0 },
                    { q: "20. Igneous rocks form from cooled", options: ["A. Magma", "B. Water", "C. Soil", "D. Ice"], ans: 0 },
                    { q: "21. Sedimentary rocks are made from small pieces called", options: ["A. Sediments", "B. Waves", "C. Clouds", "D. Crystals"], ans: 0 },
                    { q: "22. Metamorphic rocks change because of heat and", options: ["A. Rain", "B. Pressure", "C. Wind", "D. Ice"], ans: 1 },
                    { q: "23. Granite is an example of an _______ rock", options: ["A. Igneous", "B. Sedimentary", "C. Liquid", "D. Soft"], ans: 0 },
                    { q: "24. Marble is a rock", options: ["A. Igneous", "B. Sedimentary", "C. Metamorphic", "D. Gas"], ans: 2 },
                    { q: "25. The Mohs scale measures mineral", options: ["A. Color", "B. Hardness", "C. Size", "D. Shape"], ans: 1 },
                    { q: "26. Breaking rocks into small pieces is called", options: ["A. Weathering", "B. Melting", "C. Burning", "D. Cooling"], ans: 0 },
                    { q: "27. Moving rocks by wind or water is called", options: ["A. Erosion", "B. Freezing", "C. Heating", "D. Pressing"], ans: 0 },
                    { q: "28. The rock cycle shows how rocks", options: ["A. Change", "B. Sleep", "C. Shine", "D. Float"], ans: 0 },
                    { q: "29. Fossils are usually found in rocks", options: ["A. Sedimentary", "B. Igneous", "C. Melted", "D. Liquid"], ans: 0 },
                    { q: "30. Both mineralogy and petrology are part of", options: ["A. Biology", "B. Geology", "C. Astronomy", "D. Physics"], ans: 1 }
                ]
            },
            "arjey2": {
                title: "Pretest arjey2",
                discussion: "Module 10: Earth's Layers and Surface\nThe Earth has four main layers: crust, mantle, outer core, and inner core. We live on the crust. The mantle is thick and hot. The outer core is liquid metal, and the inner core is solid and very hot. The Earth's surface has mountains, rivers, oceans, and plains. The study of the Earth and its layers is called Geology.\n\nModule 11: Plate Tectonics\nThe Earth's crust is broken into large plates. These plates move slowly. When they move, they can cause earthquakes and volcanoes. The study of plate movement is part of Geology and is called Plate Tectonics.",
                questions: [
                    { q: "1. Which layer do we live on?", options: ["A. Crust", "B. Mantle", "C. Core", "D. Inner core"], ans: 0 },
                    { q: "2. Which is the thickest layer of the Earth?", options: ["A. Crust", "B. Mantle", "C. Ocean", "D. Sky"], ans: 1 },
                    { q: "3. What is the center of the Earth called?", options: ["A. Crust", "B. Mantle", "C. Core", "D. Soil"], ans: 2 },
                    { q: "4. The outer core is", options: ["A. Solid", "B. Liquid", "C. Cold", "D. Air"], ans: 1 },
                    { q: "5. The inner core is very", options: ["A. Cold", "B. Hot", "C. Soft", "D. Wet"], ans: 1 },
                    { q: "6. The crust is broken into big pieces called", options: ["A. Plates", "B. Clouds", "C. Trees", "D. Waves"], ans: 0 },
                    { q: "7. Mountains are found on the Earth's", options: ["A. Core", "B. Surface", "C. Mantle", "D. Center"], ans: 1 },
                    { q: "8. As we go deeper inside the Earth, it gets", options: ["A. Colder", "B. Hotter", "C. Lighter", "D. Smaller"], ans: 1 },
                    { q: "9. The study of the Earth and its layers is called", options: ["A. Biology", "B. Geology", "C. Astronomy", "D. Chemistry"], ans: 1 },
                    { q: "10. A scientist who studies the Earth is called a", options: ["A. Biologist", "B. Geologist", "C. Astronaut", "D. Chemist"], ans: 1 },
                    { q: "11. How many main layers does the Earth have?", options: ["A. Two", "B. Three", "C. Four", "D. Five"], ans: 2 },
                    { q: "12. The mantle is very", options: ["A. Thick", "B. Thin", "C. Cold", "D. Small"], ans: 0 },
                    { q: "13. Oceans are part of the Earth's", options: ["A. Core", "B. Surface", "C. Mantle", "D. Inner core"], ans: 1 },
                    { q: "14. The inner core is", options: ["A. Liquid", "B. Solid", "C. Gas", "D. Water"], ans: 1 },
                    { q: "15. Rivers flow on the Earth's", options: ["A. Surface", "B. Core", "C. Mantle", "D. Center"], ans: 0 },
                    { q: "16. The big pieces of the crust are called", options: ["A. Plates", "B. Clouds", "C. Waves", "D. Trees"], ans: 0 },
                    { q: "17. Plates move very", options: ["A. Fast", "B. Slowly", "C. Never", "D. Backward"], ans: 1 },
                    { q: "18. Moving plates can cause", options: ["A. Rainbows", "B. Earthquakes", "C. Seasons", "D. Day and night"], ans: 1 },
                    { q: "19. A mountain that erupts lava is a", options: ["A. Hill", "B. Volcano", "C. Valley", "D. Plain"], ans: 1 },
                    { q: "20. Most earthquakes happen near plate", options: ["A. Centers", "B. Boundaries", "C. Rivers", "D. Farm"], ans: 1 },
                    { q: "21. When plates push together, they can form", options: ["A. Rivers", "B. Mountains", "C. Clouds", "D. Lakes"], ans: 1 },
                    { q: "22. When plates move apart, new ocean floor can", options: ["A. Break", "B. Form", "C. Melt", "D. Sink"], ans: 1 },
                    { q: "23. The study of plate movement is called", options: ["A. Biology", "B. Plate Tectonics", "C. Ecology", "D. Astronomy"], ans: 1 },
                    { q: "24. A scientist who studies earthquakes is called a", options: ["A. Seismologist", "B. Dentist", "C. Pilot", "D. Engineer"], ans: 0 },
                    { q: "25. Volcanoes are common near plate", options: ["A. Boundaries", "B. Centers", "C. Lakes", "D. Forests"], ans: 0 },
                    { q: "26. The shaking of the ground is called an", options: ["A. Eruption", "B. Earthquake", "C. Flood", "D. Storm"], ans: 1 },
                    { q: "27. When one plate goes under another, it is called", options: ["A. Subduction", "B. Freezing", "C. Burning", "D. Evaporation"], ans: 0 },
                    { q: "28. Heat inside the Earth causes plates to", options: ["A. Sleep", "B. Move", "C. Stop", "D. Shine"], ans: 1 },
                    { q: "29. The Pacific Ring of Fire has many", options: ["A. Earthquakes and volcanoes", "B. Snowstorms", "C. Rivers", "D. Forests"], ans: 0 },
                    { q: "30. Thailand can experience earthquakes because of moving", options: ["A. Clouds", "B. Plates", "C. Winds", "D. Ice"], ans: 1 }
                ]
            }
        };

        let currentQuiz = null;
        let userAnswers = {};
        let timeLeft = 60 * 60; // 60 นาที
        let timerInterval;

        // เริ่มทำข้อสอบ
        function startQuiz(quizId) {
            currentQuiz = quizData[quizId];
            userAnswers = {};
            
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('quiz-title').innerText = currentQuiz.title;

            // จัดการ Short Discussion
            const discussionBox = document.getElementById('discussion-box');
            if (currentQuiz.discussion) {
                document.getElementById('discussion-text').innerText = currentQuiz.discussion;
                discussionBox.classList.remove('hidden');
            } else {
                discussionBox.classList.add('hidden');
            }

            renderQuestions();
            
            // เริ่มจับเวลา
            timeLeft = 60 * 60;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert("หมดเวลา! ระบบจะส่งคำตอบอัตโนมัติ");
                    submitQuiz();
                }
            }, 1000);
            
            window.scrollTo(0, 0);
        }

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        // สร้าง HTML สำหรับคำถาม
        function renderQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';

            currentQuiz.questions.forEach((item, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-white p-6 rounded-xl shadow-sm border border-gray-100';
                
                let html = `<p class="font-semibold text-lg mb-4">${item.q}</p>`;
                
                item.options.forEach((opt, optIndex) => {
                    html += `
                        <label>
                            <input type="radio" name="q${index}" value="${optIndex}" onchange="saveAnswer(${index}, ${optIndex})">
                            <span class="option-label text-sm md:text-base">${opt}</span>
                        </label>
                    `;
                });
                
                questionDiv.innerHTML = html;
                container.appendChild(questionDiv);
            });
        }

        function saveAnswer(qIndex, optIndex) {
            userAnswers[qIndex] = optIndex;
        }

        function confirmSubmit() {
            const answeredCount = Object.keys(userAnswers).length;
            const total = currentQuiz.questions.length;
            
            if (answeredCount < total) {
                if(!confirm(`คุณทำไปแล้ว ${answeredCount} จาก ${total} ข้อ แน่ใจหรือไม่ว่าจะส่งคำตอบ?`)) return;
            } else {
                if(!confirm('แน่ใจหรือไม่ว่าจะส่งคำตอบ?')) return;
            }
            submitQuiz();
        }

        // ส่งและตรวจข้อสอบ
        function submitQuiz() {
            clearInterval(timerInterval);
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            
            let score = 0;
            const reviewContainer = document.getElementById('review-container');
            reviewContainer.innerHTML = '';

            currentQuiz.questions.forEach((item, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === item.ans;
                if (isCorrect) score++;

                const reviewDiv = document.createElement('div');
                reviewDiv.className = `p-6 rounded-xl shadow-sm border-l-8 ${isCorrect ? 'border-green-500 bg-white' : 'border-red-500 bg-white'}`;
                
                let reviewHtml = `
                    <div class="flex items-center mb-3">
                        <span class="${isCorrect ? 'text-green-500' : 'text-red-500'} font-bold text-xl mr-2">
                            ${isCorrect ? '✓ ถูกต้อง' : '✗ ผิด'}
                        </span>
                    </div>
                    <p class="font-semibold mb-4 text-gray-800">${item.q}</p>
                `;

                item.options.forEach((opt, optIndex) => {
                    let optionClass = "block p-3 mb-2 rounded border border-gray-200 text-gray-500 bg-gray-50";
                    
                    if (optIndex === item.ans) {
                        // ข้อที่ถูกเสมอ
                        optionClass = "block p-3 mb-2 rounded border-2 border-green-500 bg-green-50 text-green-700 font-medium";
                    } else if (optIndex === userAnswer && !isCorrect) {
                        // ข้อที่ผู้ใช้เลือกแต่ผิด
                        optionClass = "block p-3 mb-2 rounded border-2 border-red-500 bg-red-50 text-red-700 font-medium line-through";
                    }

                    reviewHtml += `<div class="${optionClass}">${opt}</div>`;
                });

                reviewDiv.innerHTML = reviewHtml;
                reviewContainer.appendChild(reviewDiv);
            });

            document.getElementById('score-display').innerText = score;
            document.getElementById('total-display').innerText = currentQuiz.questions.length;
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
